Tests:
  - Name: Admin login
    ExpectedResult: false
    Log: {
      "event": {
        "action": "SIGN_IN",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "LOGIN",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {},
        "preaction": {},
        "recordid": "320",
        "resource": "None",
        "result": "SUCCESS",
        "subcategory": "LOGIN",
        "time": "2024-10-22 21:48:59.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }
  - Name: T1136.003 Create Cloud Account
  # Administration > User Management > Add User, Service Admin group
  # https://help.zscaler.com/zia/choosing-provisioning-and-authentication-methods
    ExpectedResult: false
    Log: {
      "event": {
        "action": "CREATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "USER_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "department": {
            "id": 16991313,
            "isDeleted": false,
            "isForUnauthenticatedUser": false,
            "isNonEditable": true,
            "name": "Service Admin"
          },
          "email": "ariel@dev-panther.com",
          "groups": [
            {
              "id": 16991312,
              "isNonEditable": true,
              "name": "Service Admin"
            }
          ],
          "id": 19752821,
          "miscflags": 0,
          "name": "ariel",
          "password": "*****",
          "systemDefinedGroups": []
        },
        "preaction": {
          "department": {
            "id": 16991313,
            "isDeleted": false,
            "isForUnauthenticatedUser": false,
            "isNonEditable": true,
            "name": "Service Admin"
          },
          "email": "ariel@dev-panther.com",
          "groups": [
            {
              "id": 16991312,
              "isNonEditable": true,
              "name": "Service Admin"
            }
          ],
          "id": 19752821,
          "miscflags": 0,
          "name": "ariel",
          "password": "*****",
          "systemDefinedGroups": []
        },
        "recordid": "321",
        "resource": "ariel",
        "result": "SUCCESS",
        "subcategory": "USER",
        "time": "2024-10-22 21:57:58.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1098.003 Additional Cloud Roles
  # Administration > User Management > Add User, assign to Service Admin group
    ExpectedResult: false
    Log: {
      "event": {
        "action": "UPDATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "USER_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "adminUser": false,
          "department": {
            "id": 19752838,
            "isDeleted": false,
            "isForUnauthenticatedUser": false,
            "isNonEditable": false,
            "name": "test"
          },
          "email": "ariel@dev-panther.com",
          "groups": [
            {
              "id": 16991312,
              "isNonEditable": true,
              "name": "Service Admin"
            },
            {
              "id": 19631231,
              "isNonEditable": false,
              "name": "test"
            }
          ],
          "id": 19752821,
          "isNonEditable": false,
          "miscflags": 0,
          "name": "ariel",
          "systemDefinedGroups": []
        },
        "preaction": {
          "adminUser": false,
          "authType": "SAFECHANNEL_DIR",
          "department": {
            "id": 19752838,
            "isDeleted": false,
            "isForUnauthenticatedUser": false,
            "isNonEditable": false,
            "name": "test"
          },
          "email": "ariel@dev-panther.com",
          "groups": [
            {
              "id": 19631231,
              "isNonEditable": false,
              "name": "test"
            }
          ],
          "id": 19752821,
          "miscflags": 268435456,
          "name": "ariel"
        },
        "recordid": "325",
        "resource": "ariel",
        "result": "SUCCESS",
        "subcategory": "USER",
        "time": "2024-10-22 22:02:29.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1531 Account Access Removal
  # Administration > User Management > Add User, remove from Service Admin group
    ExpectedResult: false
    Log: {
      "event": {
        "action": "UPDATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "USER_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "adminUser": false,
          "department": {
            "id": 19752838,
            "isDeleted": false,
            "isForUnauthenticatedUser": false,
            "isNonEditable": false,
            "name": "test"
          },
          "email": "ariel@dev-panther.com",
          "groups": [
            {
              "id": 19631231,
              "isNonEditable": false,
              "name": "test"
            }
          ],
          "id": 19752821,
          "isNonEditable": false,
          "miscflags": 0,
          "name": "ariel",
          "systemDefinedGroups": []
        },
        "preaction": {
          "adminUser": false,
          "authType": "SAFECHANNEL_DIR",
          "department": {
            "id": 16991313,
            "isDeleted": false,
            "isForUnauthenticatedUser": false,
            "isNonEditable": false,
            "name": "Service Admin"
          },
          "email": "ariel@dev-panther.com",
          "groups": [
            {
              "id": 16991312,
              "isNonEditable": false,
              "name": "Service Admin"
            }
          ],
          "id": 19752821,
          "miscflags": 268435456,
          "name": "ariel"
        },
        "recordid": "324",
        "resource": "ariel",
        "result": "SUCCESS",
        "subcategory": "USER",
        "time": "2024-10-22 22:01:28.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }
      
  - Name: T1136.003 Create Cloud Account # Administrator!!
  # Administration Management > Administrators > Add Administrator
    ExpectedResult: true
    Log: {
      "event": {
        "action": "CREATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ADMINISTRATOR_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "adminScope": {
            "scopeEntities": [],
            "scopeGroupMemberEntities": [],
            "type": "ORGANIZATION"
          },
          "disabled": false,
          "email": "ariel.ropek@panther.com",
          "id": 19752821,
          "isExecMobileAppEnabled": true,
          "isPasswordLoginAllowed": true,
          "loginName": "ariel@dev-panther.com",
          "pwdLastModifiedTime": 1729634767,
          "role": {
            "deleted": false,
            "extensions": {
              "adminRank": "0",
              "roleType": "EXEC_INSIGHT_AND_ORG_ADMIN"
            },
            "id": 24354,
            "isNameL10nTag": true,
            "name": "Super Admin"
          },
          "userName": "ariel1123"
        },
        "preaction": {
          "adminScope": {
            "scopeEntities": [],
            "scopeGroupMemberEntities": [],
            "type": "ORGANIZATION"
          },
          "disabled": false,
          "email": "ariel.ropek@panther.com",
          "id": 0,
          "isAuditor": false,
          "isDefaultAdmin": false,
          "isExecMobileAppEnabled": true,
          "isPasswordExpired": false,
          "isPasswordLoginAllowed": true,
          "loginName": "ariel@dev-panther.com",
          "newLocationCreateAllowed": false,
          "password": "*****",
          "pwdLastModifiedTime": 0,
          "role": {
            "deleted": false,
            "id": 24354,
            "isNameL10nTag": false,
            "name": "Super Admin"
          },
          "userName": "ariel1123"
        },
        "recordid": "326",
        "resource": "ariel1123",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ADMIN_USER",
        "time": "2024-10-22 22:06:04.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1531 Account Access Removal
  # Administration Management > Administrators > Edit Administrator, delete administrator
    ExpectedResult: true
    Log: {
      "event": {
        "action": "DELETE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ADMINISTRATOR_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {},
        "preaction": {
          "adminScope": {
            "scopeEntities": [],
            "scopeGroupMemberEntities": [],
            "type": "ORGANIZATION"
          },
          "disabled": false,
          "email": "ariel.ropek@panther.com",
          "id": 19752821,
          "isExecMobileAppEnabled": true,
          "isPasswordLoginAllowed": true,
          "loginName": "ariel@dev-panther.com",
          "pwdLastModifiedTime": 1729634767,
          "role": {
            "deleted": false,
            "extensions": {
              "adminRank": "0",
              "roleType": "EXEC_INSIGHT_AND_ORG_ADMIN"
            },
            "id": 24354,
            "isNameL10nTag": true,
            "name": "Super Admin"
          },
          "userName": "ariel1123"
        },
        "recordid": "327",
        "resource": "ariel1123",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ADMIN_USER",
        "time": "2024-10-22 22:09:01.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1136.003 Create Cloud Account 
  # Administration Management  > Auditors > Add Auditor
    ExpectedResult: true
    Log: {
      "event": {
        "action": "CREATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ADMINISTRATOR_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "disabled": false,
          "id": 19752860,
          "isAuditor": true,
          "loginName": "arieeel@dev-panther.com",
          "newLocationCreateAllowed": false,
          "pwdLastModifiedTime": 0,
          "role": {
            "deleted": false,
            "id": 30510,
            "isNameL10nTag": false,
            "name": "Auditor"
          },
          "userName": "areiiiel"
        },
        "preaction": {
          "adminScope": {
            "scopeEntities": [],
            "scopeGroupMemberEntities": [],
            "type": "ORGANIZATION"
          },
          "disabled": false,
          "id": 0,
          "isAuditor": true,
          "loginName": "arieeel@dev-panther.com",
          "newLocationCreateAllowed": false,
          "password": "*****",
          "pwdLastModifiedTime": 0,
          "userName": "areiiiel"
        },
        "recordid": "328",
        "resource": "areiiiel",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_AUDITOR",
        "time": "2024-10-22 22:10:28.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1531 Account Access Removal
  # Administration Management > Auditors > Edit Auditor, delete auditor
    ExpectedResult: true
    Log: {
      "event": {
        "action": "DELETE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ADMINISTRATOR_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {},
        "preaction": {
          "disabled": false,
          "id": 19752860,
          "isAuditor": true,
          "loginName": "arieeel@dev-panther.com",
          "newLocationCreateAllowed": false,
          "pwdLastModifiedTime": 0,
          "role": {
            "deleted": false,
            "id": 30510,
            "isNameL10nTag": false,
            "name": "Auditor"
          },
          "userName": "areiiiel"
        },
        "recordid": "329",
        "resource": "areiiiel",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_AUDITOR",
        "time": "2024-10-22 22:11:56.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: Administration Management > Administrator Management > Set Password Expriration 180 days
    ExpectedResult: true
    Log: {
      "event": {
        "action": "UPDATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "LOGIN",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "passwordExpirationEnabled": true,
          "passwordExpiryDays": 180
        },
        "preaction": {
          "passwordExpirationEnabled": false,
          "passwordExpiryDays": 180
        },
        "recordid": "331",
        "resource": "None",
        "result": "SUCCESS",
        "subcategory": "PASSWORD_EXPIRY",
        "time": "2024-10-22 22:12:25.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: Administration Management > Administrator Management > Remove Password Expriration
    ExpectedResult: true
    Log: {
      "event": {
        "action": "UPDATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "LOGIN",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "passwordExpirationEnabled": false,
          "passwordExpiryDays": 180
        },
        "preaction": {
          "passwordExpirationEnabled": true,
          "passwordExpiryDays": 180
        },
        "recordid": "331",
        "resource": "None",
        "result": "SUCCESS",
        "subcategory": "PASSWORD_EXPIRY",
        "time": "2024-10-22 22:12:25.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1484.002 Trust Modification
  # Administration > Administration Management > Enable SAML Authentication
    ExpectedResult: true
    Log: {
      "event": {
        "action": "UPDATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ADMINISTRATOR_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "certFilename": "abc.crt",
          "productId": 0,
          "samlEnabled": true
        },
        "preaction": {
          "productId": 0,
          "samlEnabled": false
        },
        "recordid": "332",
        "resource": "None",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_SAML",
        "time": "2024-10-22 22:13:23.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1484.002 Trust Modification
  # Administration > Administration Management > Disable SAML Authentication
    ExpectedResult: true
    Log: {
      "event": {
        "action": "UPDATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ADMINISTRATOR_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "certFilename": "abc.crt",
          "productId": 0,
          "samlEnabled": false
        },
        "preaction": {
          "productId": 0,
          "samlEnabled": true
        },
        "recordid": "332",
        "resource": "None",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_SAML",
        "time": "2024-10-22 22:13:23.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1098.003 Additional Cloud Roles
  # Administration > Role Management > Add Administrator Role, all permissions
    ExpectedResult: true
    Log: {
      "event": {
        "action": "CREATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ROLE_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "adminAcctAccess": "READ_WRITE",
          "alertingAccess": "READ_WRITE",
          "analysisAccess": "READ_ONLY",
          "dashboardAccess": "READ_WRITE",
          "deviceInfoAccess": "READ_ONLY",
          "id": 32780,
          "logsLimit": "Unrestricted",
          "name": "mega admin",
          "permissions": [
            "ADVANCED_SETTINGS",
            "COMPLY",
            "FIREWALL_DNS",
            "NSS_CONFIGURATION",
            "SECURE",
            "SSL_POLICY",
            "VZEN_CONFIGURATION",
            "PARTNER_INTEGRATION",
            "REMOTE_ASSISTANCE_MANAGEMENT",
            "LOCATIONS",
            "VPN_CREDENTIALS",
            "HOSTED_PAC_FILES",
            "EZ_AGENT_CONFIGURATIONS",
            "SECURE_AGENT_NOTIFICATIONS",
            "PROXY_GATEWAY",
            "STATIC_IPS",
            "GRE_TUNNELS",
            "SUBCLOUDS",
            "AUTHENTICATION_SETTINGS",
            "USER_MANAGEMENT",
            "IDENTITY_PROXY_SETTINGS",
            "APIKEY_MANAGEMENT",
            "POLICY_RESOURCE_MANAGEMENT",
            "CLIENT_CONNECTOR_PORTAL",
            "CUSTOM_URL_CAT",
            "OVERRIDE_EXISTING_CAT",
            "TENANT_PROFILE_MANAGEMENT"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "READ_WRITE",
          "reportTimeDuration": -1,
          "roleType": "EXEC_INSIGHT_AND_ORG_ADMIN",
          "usernameAccess": "READ_ONLY"
        },
        "preaction": {
          "adminAcctAccess": "READ_WRITE",
          "alertingAccess": "READ_WRITE",
          "analysisAccess": "READ_ONLY",
          "dashboardAccess": "READ_WRITE",
          "deviceInfoAccess": "READ_ONLY",
          "id": 0,
          "isAuditor": false,
          "isNonEditable": false,
          "logsLimit": "Unrestricted",
          "name": "mega admin",
          "permissions": [
            "ADVANCED_SETTINGS",
            "COMPLY",
            "FIREWALL_DNS",
            "NSS_CONFIGURATION",
            "SECURE",
            "SSL_POLICY",
            "VZEN_CONFIGURATION",
            "PARTNER_INTEGRATION",
            "REMOTE_ASSISTANCE_MANAGEMENT",
            "LOCATIONS",
            "VPN_CREDENTIALS",
            "HOSTED_PAC_FILES",
            "EZ_AGENT_CONFIGURATIONS",
            "SECURE_AGENT_NOTIFICATIONS",
            "PROXY_GATEWAY",
            "STATIC_IPS",
            "GRE_TUNNELS",
            "SUBCLOUDS",
            "AUTHENTICATION_SETTINGS",
            "USER_MANAGEMENT",
            "IDENTITY_PROXY_SETTINGS",
            "APIKEY_MANAGEMENT",
            "POLICY_RESOURCE_MANAGEMENT",
            "CLIENT_CONNECTOR_PORTAL",
            "CUSTOM_URL_CAT",
            "OVERRIDE_EXISTING_CAT",
            "TENANT_PROFILE_MANAGEMENT"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "READ_WRITE",
          "reportTimeDuration": -1,
          "roleType": "EXEC_INSIGHT_AND_ORG_ADMIN",
          "usernameAccess": "READ_ONLY"
        },
        "recordid": "341",
        "resource": "mega admin",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ROLE",
        "time": "2024-10-22 22:19:57.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1531 Account Access Removal
  # Administration > Role Management > Edit Administrator Role, delete role
    ExpectedResult: true
    Log: {
      "event": {
        "action": "DELETE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ROLE_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {},
        "preaction": {
          "adminAcctAccess": "READ_WRITE",
          "alertingAccess": "READ_WRITE",
          "analysisAccess": "READ_ONLY",
          "dashboardAccess": "READ_WRITE",
          "deviceInfoAccess": "READ_ONLY",
          "id": 32780,
          "logsLimit": "Unrestricted",
          "name": "mega admin",
          "permissions": [
            "SECURE",
            "COMPLY",
            "SSL_POLICY",
            "ADVANCED_SETTINGS",
            "FIREWALL_DNS",
            "NSS_CONFIGURATION",
            "VZEN_CONFIGURATION",
            "LOCATIONS",
            "HOSTED_PAC_FILES",
            "EZ_AGENT_CONFIGURATIONS",
            "SECURE_AGENT_NOTIFICATIONS",
            "VPN_CREDENTIALS",
            "AUTHENTICATION_SETTINGS",
            "IDENTITY_PROXY_SETTINGS",
            "USER_MANAGEMENT",
            "APIKEY_MANAGEMENT",
            "PARTNER_INTEGRATION",
            "POLICY_RESOURCE_MANAGEMENT",
            "CUSTOM_URL_CAT",
            "OVERRIDE_EXISTING_CAT",
            "PROXY_GATEWAY",
            "TENANT_PROFILE_MANAGEMENT",
            "STATIC_IPS",
            "REMOTE_ASSISTANCE_MANAGEMENT",
            "GRE_TUNNELS",
            "CLIENT_CONNECTOR_PORTAL",
            "SUBCLOUDS"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "READ_WRITE",
          "reportTimeDuration": -1,
          "roleType": "EXEC_INSIGHT_AND_ORG_ADMIN",
          "usernameAccess": "READ_ONLY"
        },
        "recordid": "342",
        "resource": "mega admin",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ROLE",
        "time": "2024-10-22 22:31:35.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1098.003 Additional Cloud Roles
  # Administration > Role Management > Add SD-WAN Partner API Role, all permissions
    ExpectedResult: true
    Log: {
      "event": {
        "action": "CREATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ROLE_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "adminAcctAccess": "NONE",
          "alertingAccess": "READ_ONLY",
          "analysisAccess": "NONE",
          "dashboardAccess": "NONE",
          "deviceInfoAccess": "NONE",
          "id": 32781,
          "name": "wanny",
          "permissions": [
            "LOCATIONS",
            "VPN_CREDENTIALS",
            "STATIC_IPS",
            "GRE_TUNNELS"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "NONE",
          "reportTimeDuration": -1,
          "roleType": "SDWAN",
          "usernameAccess": "NONE"
        },
        "preaction": {
          "id": 0,
          "name": "wanny",
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportTimeDuration": -1,
          "roleType": "SDWAN"
        },
        "recordid": "343",
        "resource": "wanny",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ROLE",
        "time": "2024-10-22 22:31:46.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1531 Account Access Removal
  # Administration > Role Management > Edit SD-WAN Partner API Role, delete role
    ExpectedResult: true
    Logs: {
      "event": {
        "action": "DELETE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ROLE_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {},
        "preaction": {
          "adminAcctAccess": "NONE",
          "alertingAccess": "READ_ONLY",
          "analysisAccess": "NONE",
          "dashboardAccess": "NONE",
          "deviceInfoAccess": "NONE",
          "id": 32781,
          "name": "wanny",
          "permissions": [
            "STATIC_IPS",
            "LOCATIONS",
            "GRE_TUNNELS",
            "VPN_CREDENTIALS"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "NONE",
          "reportTimeDuration": -1,
          "roleType": "SDWAN",
          "usernameAccess": "NONE"
        },
        "recordid": "345",
        "resource": "wanny",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ROLE",
        "time": "2024-10-22 22:34:58.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1098.003 Additional Cloud Roles
  # Administration > Role Management > Add API Role, all permissions
    ExpectedResult: true
    Log: {
      "event": {
        "action": "CREATE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ROLE_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {
          "adminAcctAccess": "READ_WRITE",
          "alertingAccess": "NONE",
          "analysisAccess": "NONE",
          "dashboardAccess": "NONE",
          "deviceInfoAccess": "NONE",
          "id": 32782,
          "logsLimit": "Unrestricted",
          "name": "bad API",
          "permissions": [
            "ADVANCED_SETTINGS",
            "COMPLY",
            "FIREWALL_DNS",
            "SECURE",
            "SSL_POLICY",
            "LOCATIONS",
            "VPN_CREDENTIALS",
            "STATIC_IPS",
            "GRE_TUNNELS",
            "USER_MANAGEMENT",
            "POLICY_RESOURCE_MANAGEMENT",
            "CUSTOM_URL_CAT",
            "OVERRIDE_EXISTING_CAT"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "NONE",
          "reportTimeDuration": -1,
          "roleType": "PUBLIC_API",
          "usernameAccess": "NONE"
        },
        "preaction": {
          "adminAcctAccess": "READ_WRITE",
          "id": 0,
          "isAuditor": false,
          "isNonEditable": false,
          "logsLimit": "Unrestricted",
          "name": "bad API",
          "permissions": [
            "ADVANCED_SETTINGS",
            "COMPLY",
            "FIREWALL_DNS",
            "SECURE",
            "SSL_POLICY",
            "LOCATIONS",
            "VPN_CREDENTIALS",
            "STATIC_IPS",
            "GRE_TUNNELS",
            "USER_MANAGEMENT",
            "POLICY_RESOURCE_MANAGEMENT",
            "CUSTOM_URL_CAT",
            "OVERRIDE_EXISTING_CAT"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportTimeDuration": -1,
          "roleType": "PUBLIC_API"
        },
        "recordid": "344",
        "resource": "bad API",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ROLE",
        "time": "2024-10-22 22:34:34.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }

  - Name: T1531 Account Access Removal
  # Administration > Role Management > Edit API Role, delete role
    ExpectedResult: true
    Log: {
      "event": {
        "action": "DELETE",
        "adminid": "admin@16991311.zscalerbeta.net",
        "auditlogtype": "ZIA",
        "category": "ROLE_MANAGEMENT",
        "clientip": "123.123.123.123",
        "errorcode": "None",
        "interface": "UI",
        "postaction": {},
        "preaction": {
          "adminAcctAccess": "READ_WRITE",
          "alertingAccess": "NONE",
          "analysisAccess": "NONE",
          "dashboardAccess": "NONE",
          "deviceInfoAccess": "NONE",
          "id": 32782,
          "logsLimit": "Unrestricted",
          "name": "bad API",
          "permissions": [
            "SECURE",
            "COMPLY",
            "SSL_POLICY",
            "ADVANCED_SETTINGS",
            "FIREWALL_DNS",
            "LOCATIONS",
            "VPN_CREDENTIALS",
            "USER_MANAGEMENT",
            "POLICY_RESOURCE_MANAGEMENT",
            "CUSTOM_URL_CAT",
            "OVERRIDE_EXISTING_CAT",
            "STATIC_IPS",
            "GRE_TUNNELS"
          ],
          "policyAccess": "READ_WRITE",
          "rank": 7,
          "reportAccess": "NONE",
          "reportTimeDuration": -1,
          "roleType": "PUBLIC_API",
          "usernameAccess": "NONE"
        },
        "recordid": "346",
        "resource": "bad API",
        "result": "SUCCESS",
        "subcategory": "ADMINISTRATOR_ROLE",
        "time": "2024-10-22 22:35:06.000000000"
      },
      "sourcetype": "zscalernss-audit"
    }
  